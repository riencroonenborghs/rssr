!!!
%html
  %head
    %title RSSr
    %meta(name="viewport" content="width=device-width, initial-scale=1")
    = favicon_link_tag asset_path("favicon.png")
    %link(rel="apple-touch-icon" href="#{asset_path("apple-touch.png")}")
    = csrf_meta_tags
    = csp_meta_tag

    = stylesheet_link_tag 'application', media: 'all'
    = javascript_pack_tag 'application'
    %link(rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css")

  %body(class="#{"darkmode" if @darkmode}")
    %nav.navbar.sticky-top.border-bottom
      .container-fluid
        %div
          = link_to "#calendarOffCancas", class: "btn pt-0", "data-bs-toggle" => "offcanvas" do
            %i.bi.bi-rss
          = link_to root_path, class: "navbar-brand" do
            RSSr
                
        .d-flex
          = link_to new_search_path, class: "btn" do
            %i.bi.bi-search
          - if signed_in?
            = link_to visit_admin_entries_path(root: true), method: :post, class: "btn" do
              %i.bi.bi-arrow-counterclockwise
            = link_to admin_feeds_path, class: "btn" do
              %i.bi.bi-wrench
            = link_to destroy_user_session_path, method: :delete, class: "btn" do
              %i.bi.bi-lock
          - else
            = link_to new_user_session_path, class: "btn" do
              %i.bi.bi-unlock

    = yield

    - if flash[:alert]
      .position-fixed.bottom-0.end-0.toast.align-items-center.text-white.bg-danger.border-0.show(role="alert" aria-live="assertive" aria-atomic="true")
        .d-flex
          .toast-body
            =flash[:alert]
          %button.btn-close.btn-close-white.me-2.m-auto(type="button" data-bs-dismiss="toast" aria-label="Close")

    - if flash[:notice]
      .position-fixed.bottom-0.end-0.toast.align-items-center.text-white.bg-success.border-0.show(role="notice" aria-live="assertive" aria-atomic="true")
        .d-flex
          .toast-body
            =flash[:notice]
          %button.btn-close.btn-close-white.me-2.m-auto(type="button" data-bs-dismiss="toast" aria-label="Close")

    #calendarOffCancas.offcanvas.offcanvas-start(tabindex="-1" aria-labelledby="calendarOffCancasLabel")
      .offcanvas-header
        %h5.offcanvas-title#calendarOffCancasLabel Last 24 hours
        %button.btn-close.text-reset(type="button" data-bs-dismiss="offcanvas" aria-label="Close")
      .offcanvas-body
        %div
          %table.table
            %tr.fw-bold
              %td= link_to "All", root_path, class: "text-decoration-none"
              %td.fs-10.fw-lighter
                - if user_signed_in?
                  =Entry.joins(feed: :user).where("users.id = ?", current_user.id).count
                - else
                  =Entry.count
            - @feeds.each do |feed|
              - count = feed.entries.last_24h.count
              - unless count.zero?
                %tr
                  %td= link_to feed.title, day_feed_entries_path(feed), class: "text-decoration-none"
                  %td.fs-10.fw-lighter
                    =count
            

